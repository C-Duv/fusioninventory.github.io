# Introduction

FusionInventory can contact a ESX/ESXi/vCenter serveur using the VMware SOAP API.
It will identify the ESX server and the associated virtual machine. At the
end, it will push XML inventory of the machines to the server.

FusionInventory *DO NOT* use VMware Perl library.


[[!graph  src="

digraph G {

    style=filled;
    color=lightgrey;
    node [shape=box, color=purple];
    size = "5, 5";


        subgraph cluster_0 {
                style=filled;
                color=lightgrey;
                node [style=filled,color=white];
    "vCenter1" -> "esx1" -> "vCenter1";
    "vCenter1" -> "esx2" -> "vCenter1";
    "vCenter1" -> "esx3" -> "vCenter1";
    "esx1" -> "vm1" -> "esx1";
    "esx2" -> "vm2" -> "esx2";
    "esx2" -> "vm3" -> "esx2";
    "esx3" -> "vm4" -> "esx3";
    "esx3" -> "vm5" -> "esx3";
    "esx4" -> "vm6" -> "esx4";
                label = "VMware API";
        }



    "Serveur" -> "Agent" -> "Serveur";
    "Agent" -> "vCenter1" -> "Agent";
    "Agent" -> "esx4" -> "Agent";
}


"]]

# Installation
To inventory ESX or Vcenter, there is no specific agent to be installed on the ESX. The Fusioninventory agent installed on Windows or Linux, will inventory remotely by a automatic task.
For Windows host, the Fusioninventory Agent comes with the module. For Linux distribution, you must install a additional package.

On Redhat/Centos, run 

    # yum install perl-FusionInventory-Agent-Task-ESX

On Debian/Ubuntu :

    # apt-get install libfusioninventory-agent-task-esx-perl

From Source, see the [[agent source installation page|documentation/agent/installation/source]].

# From the Command line

You can use [[fusioninventory-esx|documentation/references]] and [[fusioninventory-injector|documentation/references]] to:

1. fetch the Inventories from the server
2. push the Inventories in GLPI

For example:

    # fusioninventory-esx --user root --password password --host esx-server --directory /tmp
    # fusioninventory-injector -v --file /tmp/esx-server-2011-01-25-14-11-07.ocs -u https://myserver/plugins/fusioninventory/

# From GLPI
##  Reconfiguration FusionInventory agent
First, we must designate the fusion agents who will have to perform the inventory VMware (ESX or VCenter) host.

Go to Plugins → Home → FusionInventory → Agents management

Chose a agent and enable : VMware host remote inventory :

[[!img 01_inventory-ESX.png align="center" size="500x240" alt=""]]

## Task management

### Add authentication for remote devices (VMware)
Add an authentification : 

Goto Plugins  → FusionInventory → Authentication for remote devices (VMware)

[[!img 02_authentification_vcenter.png align="center" size="500x167" alt=""]]

### Add remote devices to inventory (VMware)

Goto  Plugins → FusionInventory → Remote devices to inventory (VMware)

Click on + to add a device 

* Name : Add a description
* Type : "chose VMWARE Host"
* Add an Authentication
* IP : add an ip address

[[!img 03_vmware_devices.png align="center" size="500x159" alt=""]]

### Add a task 

Click on + to add a task :

* Configure the periodicity
* Chose Module : VMware host remote inventory
* Add Definition → Remote device inventory
* Select the agent earlier reconfigured 

[[!img 04_vmware_task.png align="center" size="500x319" alt=""]]



